private ImageContent ConvertToImageContent(byte[] imageBytes, object imageInfo)
        {
            string mimeType = "image/png"; // default

            // Try to infer from imageInfo parameter first
            if (imageInfo is UglyToad.PdfPig.Graphics.XObjectImage pdfImage)
            {
                // Map PDF image color space to mime type
                mimeType = pdfImage.IsJpeg ? "image/jpeg" : "image/png";
            }
            else if (imageInfo is string contentType)
            {
                mimeType = contentType;
            }
            else
            {
                // Try ImageSharp detection as last resort
                try
                {
                    using (var memStream = new MemoryStream(imageBytes))
                    {
                        var detectedFormat = Image.DetectFormat(memStream);
                        if (detectedFormat != null)
                        {
                            mimeType = detectedFormat.DefaultMimeType;
                        }
                    }
                }
                catch
                {
                    // Keep default mime type
                }
            }

            return new ImageContent(imageBytes, mimeType);
        }
