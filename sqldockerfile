# Start from official PowerShell image
FROM mcr.microsoft.com/powershell:latest

# Set PSGallery as a trusted repository and install required modules
RUN pwsh -NoLogo -NoProfile -Command \
    "Set-PSRepository -Name 'PSGallery' -InstallationPolicy Trusted; " `
    + "Install-Module -Name 'SqlServer' -Force -AllowClobber; " `
    + "Install-Module -Name 'dbatools' -Force -AllowClobber"

# Default command
CMD ["pwsh"]
